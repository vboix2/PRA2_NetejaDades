---
lang: ca-ES
title: "Pràctica 2: Neteja i validació de dades"
subtitle: "Tipologia i cicle de vida de les dades"
author: "Jesús Marí i Víctor Boix"
date: "Data de presentació: 11/06/2019"
output: 
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Descripció del dataset

El dataset utilitzat en aquesta pràctica s'ha obtingut de la pàgina web de *Kaggle*  (https://www.kaggle.com/c/titanic) i conté les dades dels passatgers del Titanic durant el desastre del 1912. L'objectiu d'aquest conjunt de dades és realitzar una predicció sobre la supervivència d'alguns passatgers a partir de les seves característiques. Per tant, es tracta d'una tasca de classificació on cal construir un model supervisat capaç de determinar el valor de l'atribut *Survived* (variable objectiu o dependent) a partir de la resta d'atributs (variables independents). 

Les conjunt de dades està format per dos fitxers CSV:

* *Titanic_train.csv*. Conjunt d'entrenament que servirà per entrenar el model, per tant, conté l'atribut objectiu o classe *Survived*. Està format per 891 registres i 12 atributs.
* *Titanic_test.csv*. Conjunt de prova, conté els registres sobre els que cal realitzar la predicció. Està format per 418 registres i 11 atributs.

La informació que contenen els atributs és la següent:

* *PassengerId*. Identificador únic del viatger al dataset (nombre enter).
* *Survived*. Atribut que indica si el passatger va sobreviure a la catàstrofe (1: va sobreviure, 0: va morir). Només disponible al conjunt *train*.
* *Pclass*. Indica la classe en què viatjava el passatger (1: primera classe, 2: segona classe, 3: tercera classe).
* *Name*. Nom complet del viatger (cadena de text).
* *Sex*. Sexe del viatger (male: home, female: dona).
* *Age*. Edat del viatger en anys (nombre real).
* *SibSp*. Nombre de germans, germanes o marit/muller a bord del vaixell (nombre enter).
* *Parch*. Nombre de pares o fills a bord del vaixell (nombre enter).
* *Ticket*. Nombre del tiquet (cadena de text).
* *Fare*. Import pagat pel bitllet (nombre real).
* *Cabin*. Cabina on s'allotjava el passatger (cadena de text).
* *Embarked*. Port d'embarcament del viatger (C: Cherbourg, Q: Queenstown, S: Southampton).

# 2. Integració i selecció de les dades

Per tal de realitzar els processos de neteja i anàlisi de les dades carregarem els dos fitxers en
dos dataframes que anomenarem *train* i *test*. Totes les operacions de neteja les realitzarem sobre els dos dataframes.

```{r}
# Càrrega dels fitxers de dades
train <- read.csv('../data/Titanic_train.csv')
test <- read.csv('../data/Titanic_test.csv')
```

L'atribut *PassengerId* és un identificador numèric dels registres del dataframe que no ens aporta cap informació sobre els passatgers, per tant, l'eliminarem, ja que per identificar els registres ja disposem de l'índex.

```{r}
# Eliminem l'atribut PassengerId a train i test
train <- train[,-1]
test <- test[,-1]
```

La resta d'atributs els mantindrem perquè ens donen informació sobre el viatger i poden resultar útils per al model. Podem fer una visualització dels primers registres amb la funció *head()*.

```{r}
# Primers registres del dataframe train
head(train)
```

# 3. Neteja de les dades

Comencem examinant el dataframe amb la funció *str()*, que ens mostra el tipus de dada i els valors dels primers registres per a cada atribut.

```{r}
# Examinem el conjunt train
str(train)
```

```{r}
# Examinem el conjunt test
str(test)
```

Com veiem, els atributs *Survived* i *Pclass* són de tipus enter. El primer que farem es convertir-los a tipus factor.

```{r}
# Conversió de Survived i Pclass a factor
train[,'Survived'] <- factor(train[,'Survived'])
train[,'Pclass'] <- factor(train[,'Pclass'])
test[,'Pclass'] <- factor(test[,'Pclass'])
```

L'atribut *Name* és de tipus factor, però té tant nivells com registres; en aquest cas el convertirem a character.

```{r}
# Conversió de Name a character
train[,'Name'] <- as.character(train[,'Name'])
test[,'Name'] <- as.character(test[,'Name'])
```

Després d'aquestes transformacions, els tipus de dada per a cada atribut són:

* *Factor*: Survived, Pclass, Sex, Ticket, Cabin, Embarked
* *int*: SibSp, Parch
* *num*: Age, Fare
* *chr*: Name

Abans d'analitzar els elements buit i extrems pot resultar útil mostrar un resum de les dades amb la funció *summary()*.

```{r}
# Resum de les dades train
summary(train)
```

```{r}
# Resum de les dades test
summary(test)
```


## 3.1. Elements buits

Examinem els elements buits a les columnes dels dos conjunts de dades. Podem veure que tenim molts valors NA a la columna *Age* dels dos dataframes i un a la columna *Fare* del conjunt de test. 

```{r}
# Nombre de valors NA per atribut
sapply(train, function(x) sum(is.na(x)))
sapply(test, function(x) sum(is.na(x)))
```

A més, els atributs *Cabin* i *Embarked* també contenen valors buits.

```{r}
# Nombre de valors buits per atribut
sapply(train, function(x) nrow(train[x=='',]))
sapply(test, function(x) nrow(test[x=='',]))
```


## 3.2. Valors extrems

Examinem els valors extrems amb els boxplot.stats(columna)$out

```{r}
boxplot.stats(train$Age)$out
boxplot.stats(train$Fare)$out

```


# 4. Anàlisi de dades

## 4.1. Selecció de dades

## 4.2. Normalitat i homogeneïtat de la variància

## 4.3. Proves estadístiques

# 5. Representació de dades

# 6. Resolució del problema

# 7. Codi

# 8. Recursos

